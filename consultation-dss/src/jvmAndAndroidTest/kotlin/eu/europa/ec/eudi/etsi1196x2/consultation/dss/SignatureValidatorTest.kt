/*
 * Copyright (c) 2023 European Commission
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package eu.europa.ec.eudi.etsi1196x2.consultation.dss

import eu.europa.esig.dss.model.DSSDocument
import eu.europa.esig.dss.model.InMemoryDocument
import eu.europa.esig.dss.spi.DSSUtils
import eu.europa.esig.dss.spi.validation.CommonCertificateVerifier
import eu.europa.esig.dss.spi.x509.CommonTrustedCertificateSource
import eu.europa.esig.dss.spi.x509.TrustedCertificateSource
import eu.europa.esig.dss.validation.SignedDocumentValidator
import eu.europa.esig.dss.validation.reports.Reports
import kotlinx.coroutines.test.runTest
import kotlin.test.Test
import kotlin.test.assertTrue

object DSSSignatureValidator {
    fun validate(jwt: String, certificate: ByteArray): Boolean {
        val documentValidator = documentValidator(jwt.toDSSDocument(), certificate.toCertificateSource())
        val reports = documentValidator.validateDocument()
        return isValid(reports)
    }

    private fun documentValidator(
        document: DSSDocument,
        trustedCertificateSource: TrustedCertificateSource,
    ): SignedDocumentValidator {
        val certVerifier = CommonCertificateVerifier().apply {
            setTrustedCertSources(trustedCertificateSource)
        }
        return SignedDocumentValidator.fromDocument(document).apply {
            setCertificateVerifier(certVerifier)
        }
    }

    private fun isValid(reports: Reports): Boolean {
        val simpleReport = reports.simpleReport
        val signatureId = simpleReport.firstSignatureId
        return signatureId?.let { simpleReport.isValid(it) } ?: false
    }
}

private fun String.toDSSDocument() = InMemoryDocument(toByteArray())
private fun ByteArray.toCertificateToken() = DSSUtils.loadCertificate(this)
private fun ByteArray.toCertificateSource() = CommonTrustedCertificateSource().apply {
    addCertificate(toCertificateToken())
}

class SignatureValidatorTest {

    @Test
    fun testDSSSignatureValidator() = runTest {
        val jwt = Data.jwt
        val certificate = Data.WALLET_CERT.byteInputStream().use { it.readBytes() }
        val result = DSSSignatureValidator.validate(jwt, certificate)
        assertTrue(result)
    }
}

object Data {
    val WALLET_CERT: String =
        """
        -----BEGIN CERTIFICATE-----
        MIIGzzCCBLegAwIBAgIDCx7mMA0GCSqGSIb3DQEBCwUAMDcxHDAaBgNVBAoME0V1
        cm9wZWFuIENvbW1pc3Npb24xFzAVBgNVBAMMDkNvbW1pc1NpZ24gLSAyMB4XDTI1
        MTEyMDA5MzEyNloXDTI4MTEyMDA5MzEyNlowgZcxCzAJBgNVBAYTAkxVMRIwEAYD
        VQQLDAlESUdJVC5CLjMxHDAaBgNVBAoME0V1cm9wZWFuIENvbW1pc3Npb24xMzAx
        BgkqhkiG9w0BCQEWJERJR0lULUVVLVRSVVNULU5PTi1QUk9EQGVjLmV1cm9wYS5l
        dTEhMB8GA1UEAwwYVEVTVCBFdXJvcGVhbiBDb21taXNzaW9uMIICIjANBgkqhkiG
        9w0BAQEFAAOCAg8AMIICCgKCAgEAkij7bkMVg45Ki0zqbrxJNOo7PoHp6EQrs5/q
        KEFzu6mTvow550P06NmaeTonfxa/504EiQuTksosupku+MPSF9oAmbo5ezlz43UW
        FY3IBWI4EEnmemoakY4ZZcSiNxDN7zkts2mlQAIkc6QDFA/e624yF+UiCLpbsyMW
        Ymez2bYMMduO+bnD7pztGZPgih9yzYK7efeZ2LgNd3+jWCtBXr4/+91XA1F0IEux
        TN/Yu20uO4yA4dL/+6or+pQfG96kpyLJMaliblJ7/8lBe8h3jM1BpbrodomjncHT
        bvBO+TlanZhvEMcp4dFaYu3OODqQ1NP+lo8g1fr80N8pL3wuI4TC3XqAjCG54bW8
        dzqrilT4RDapVrWFWWp8YzftkidYffoyXacrxtSSGQ3mQvMtUOk8JPl9NlrEAe2d
        IGRVuMj4gu4XCgeC3nQbp6SKJTsUO7K4RJl5ODc1gvwT+1LULDGLGkaCjP4bTSK3
        lKVjijWn3EivplbnmUmL2pWvb9RqIvvmHIMOwnhmzikF35R1HnCuyJISU1EcFcWq
        /CJAFfo09HiWcitjACSsluQIshGDFEKwMtCujSjgY22dENXejxi1whxY2bDF/X35
        3eQGD4GwU1FIQEmXwUP0zSch/8ktCo6wulN3VV4DQNRw61aAErqSi5Ji+0oLsiuo
        gR4hvzMCAwEAAaOCAYEwggF9MB0GA1UdDgQWBBQOq28wkzABsoIf+BBH5oJqgTQP
        +jAfBgNVHSMEGDAWgBSa+492ZpjcrCzXdzZxbbrjZ0eR9jAOBgNVHQ8BAf8EBAMC
        BkAwLwYDVR0RBCgwJoEkRElHSVQtRVUtVFJVU1QtTk9OLVBST0RAZWMuZXVyb3Bh
        LmV1MCMGCCsGAQUFBwEDBBcwFTATBgYEAI5GAQYwCQYHBACORgEGAjBJBgNVHR8E
        QjBAMD6gPKA6hjhodHRwOi8vY29tbWlzc2lnbi5wa2kuZWMuZXVyb3BhLmV1L2lu
        Zm8vY3JsL29ubGluZUNBLmNybDCBiQYIKwYBBQUHAQEEfTB7MEQGCCsGAQUFBzAC
        hjhodHRwOi8vY29tbWlzc2lnbi5wa2kuZWMuZXVyb3BhLmV1L2luZm8vYWlhL29u
        bGluZUNBLmNydDAzBggrBgEFBQcwAYYnaHR0cDovL2NvbW1pc3NpZ24ucGtpLmVj
        LmV1cm9wYS5ldS9vY3NwMA0GCSqGSIb3DQEBCwUAA4ICAQCVp/Sw2OcDCaGitFGP
        3zoyjiOzTPjf/or5KwwZ6P2opbSOdD8M9h05QlXPjeE/29JeJ/B1I0ZhBEXsrg69
        JB7iLqsm+3TDDhZ7m6DkMuImmeW5ihMp+E28a20ndFnDIj//XI8F41oJBw0/2Uy/
        yXloAIXx8o6UeItSI3pe3mV5cU02XmIfql80nBmK9vy14ZXbKeMRpAHH0GD8CWzM
        00+pyzzbQFuYNm/JrjmlrfNJmBUUwtZm8G9nDQBI7kcl7TbFKcllQJ5H0G00y46U
        +1ytE7r76aramBmbHhCmSWWqO8y/54Z+R/SdAt1mK4dZIXyB02aEg9KGMiNlQwfK
        gLYazlTU/KxJnjBoRYWKfPDJoRAdMaFk3gRJNij50ZENOb2zpaH0WF/0BHB+84um
        yQ09ITLPlFESo6Y5MBUENVLnYR50rmBTfKky0I3P+KGXuMvfPZc8ZB6ID5IIqi/2
        LiN6swwPGGq8s5YAC9cYjIQsV3wIhFG8FoGS4zNT8qa2eIp6WFYxjrGOelrp1Uv0
        eYZaCcKo0KATBvxWalRypA5cdyyGTXBchiElpEgVnIUc0VKPyrCpY+N1rgdSD8DO
        MSixluG17QElAxdOFv/zrHisakj1Lw+AgRyErOopC625I65Tb3EM9GNqSHXuWpMm
        fzZSoYeOr+5g22edP5vvDjuZYg==
        -----END CERTIFICATE-----
        """.trimIndent()

    val jwt: String = "eyJhbGciOiJSUzUxMiIsImN0eSI6Impzb24iLCJraWQiOiJNRUl3TzZRNU1EY3hIREFhQmdOVkJBb01FMFYxY205d1pXRnVJRU52YlcxcGMzTnBiMjR4RnpBVkJnTlZCQU1NRGtOdmJXMXBjMU5wWjI0Z0xTQXlBZ01MSHVZPSIsIng1dCNvIjp7ImRpZ0FsZyI6IlM1MTIiLCJkaWdWYWwiOiJMNlpDTHUycUNZOUVyV3E4MEJDU00wNVl1X3FMV1ktbjAtdzRhOUxzMWZIR1d4US1KbldNZTJUVUhSU19XQnF4ZHRkUEdDSk9mLW5kSTlfNEdPNFBGUSJ9LCJ4NWMiOlsiTUlJR3p6Q0NCTGVnQXdJQkFnSURDeDdtTUEwR0NTcUdTSWIzRFFFQkN3VUFNRGN4SERBYUJnTlZCQW9NRTBWMWNtOXdaV0Z1SUVOdmJXMXBjM05wYjI0eEZ6QVZCZ05WQkFNTURrTnZiVzFwYzFOcFoyNGdMU0F5TUI0WERUSTFNVEV5TURBNU16RXlObG9YRFRJNE1URXlNREE1TXpFeU5sb3dnWmN4Q3pBSkJnTlZCQVlUQWt4Vk1SSXdFQVlEVlFRTERBbEVTVWRKVkM1Q0xqTXhIREFhQmdOVkJBb01FMFYxY205d1pXRnVJRU52YlcxcGMzTnBiMjR4TXpBeEJna3Foa2lHOXcwQkNRRVdKRVJKUjBsVUxVVlZMVlJTVlZOVUxVNVBUaTFRVWs5RVFHVmpMbVYxY205d1lTNWxkVEVoTUI4R0ExVUVBd3dZVkVWVFZDQkZkWEp2Y0dWaGJpQkRiMjF0YVhOemFXOXVNSUlDSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQWc4QU1JSUNDZ0tDQWdFQWtpajdia01WZzQ1S2kwenFicnhKTk9vN1BvSHA2RVFyczUvcUtFRnp1Nm1Udm93NTUwUDA2Tm1hZVRvbmZ4YS81MDRFaVF1VGtzb3N1cGt1K01QU0Y5b0FtYm81ZXpsejQzVVdGWTNJQldJNEVFbm1lbW9ha1k0WlpjU2lOeERON3prdHMybWxRQUlrYzZRREZBL2U2MjR5RitVaUNMcGJzeU1XWW1lejJiWU1NZHVPK2JuRDdwenRHWlBnaWg5eXpZSzdlZmVaMkxnTmQzK2pXQ3RCWHI0Lys5MVhBMUYwSUV1eFROL1l1MjB1TzR5QTRkTC8rNm9yK3BRZkc5NmtweUxKTWFsaWJsSjcvOGxCZThoM2pNMUJwYnJvZG9tam5jSFRidkJPK1RsYW5aaHZFTWNwNGRGYVl1M09PRHFRMU5QK2xvOGcxZnI4ME44cEwzd3VJNFRDM1hxQWpDRzU0Ylc4ZHpxcmlsVDRSRGFwVnJXRldXcDhZemZ0a2lkWWZmb3lYYWNyeHRTU0dRM21Rdk10VU9rOEpQbDlObHJFQWUyZElHUlZ1TWo0Z3U0WENnZUMzblFicDZTS0pUc1VPN0s0UkpsNU9EYzFndndUKzFMVUxER0xHa2FDalA0YlRTSzNsS1ZqaWpXbjNFaXZwbGJubVVtTDJwV3ZiOVJxSXZ2bUhJTU93bmhtemlrRjM1UjFIbkN1eUpJU1UxRWNGY1dxL0NKQUZmbzA5SGlXY2l0akFDU3NsdVFJc2hHREZFS3dNdEN1alNqZ1kyMmRFTlhlanhpMXdoeFkyYkRGL1gzNTNlUUdENEd3VTFGSVFFbVh3VVAwelNjaC84a3RDbzZ3dWxOM1ZWNERRTlJ3NjFhQUVycVNpNUppKzBvTHNpdW9nUjRodnpNQ0F3RUFBYU9DQVlFd2dnRjlNQjBHQTFVZERnUVdCQlFPcTI4d2t6QUJzb0lmK0JCSDVvSnFnVFFQK2pBZkJnTlZIU01FR0RBV2dCU2ErNDkyWnBqY3JDelhkelp4YmJyalowZVI5akFPQmdOVkhROEJBZjhFQkFNQ0JrQXdMd1lEVlIwUkJDZ3dKb0VrUkVsSFNWUXRSVlV0VkZKVlUxUXRUazlPTFZCU1QwUkFaV011WlhWeWIzQmhMbVYxTUNNR0NDc0dBUVVGQndFREJCY3dGVEFUQmdZRUFJNUdBUVl3Q1FZSEJBQ09SZ0VHQWpCSkJnTlZIUjhFUWpCQU1ENmdQS0E2aGpob2RIUndPaTh2WTI5dGJXbHpjMmxuYmk1d2Eya3VaV011WlhWeWIzQmhMbVYxTDJsdVptOHZZM0pzTDI5dWJHbHVaVU5CTG1OeWJEQ0JpUVlJS3dZQkJRVUhBUUVFZlRCN01FUUdDQ3NHQVFVRkJ6QUNoamhvZEhSd09pOHZZMjl0YldsemMybG5iaTV3YTJrdVpXTXVaWFZ5YjNCaExtVjFMMmx1Wm04dllXbGhMMjl1YkdsdVpVTkJMbU55ZERBekJnZ3JCZ0VGQlFjd0FZWW5hSFIwY0RvdkwyTnZiVzFwYzNOcFoyNHVjR3RwTG1WakxtVjFjbTl3WVM1bGRTOXZZM053TUEwR0NTcUdTSWIzRFFFQkN3VUFBNElDQVFDVnAvU3cyT2NEQ2FHaXRGR1Azem95amlPelRQamYvb3I1S3d3WjZQMm9wYlNPZEQ4TTloMDVRbFhQamVFLzI5SmVKL0IxSTBaaEJFWHNyZzY5SkI3aUxxc20rM1RERGhaN202RGtNdUltbWVXNWloTXArRTI4YTIwbmRGbkRJai8vWEk4RjQxb0pCdzAvMlV5L3lYbG9BSVh4OG82VWVJdFNJM3BlM21WNWNVMDJYbUlmcWw4MG5CbUs5dnkxNFpYYktlTVJwQUhIMEdEOENXek0wMCtweXp6YlFGdVlObS9KcmptbHJmTkptQlVVd3RabThHOW5EUUJJN2tjbDdUYkZLY2xsUUo1SDBHMDB5NDZVKzF5dEU3cjc2YXJhbUJtYkhoQ21TV1dxTzh5LzU0WitSL1NkQXQxbUs0ZFpJWHlCMDJhRWc5S0dNaU5sUXdmS2dMWWF6bFRVL0t4Sm5qQm9SWVdLZlBESm9SQWRNYUZrM2dSSk5pajUwWkVOT2IyenBhSDBXRi8wQkhCKzg0dW15UTA5SVRMUGxGRVNvNlk1TUJVRU5WTG5ZUjUwcm1CVGZLa3kwSTNQK0tHWHVNdmZQWmM4WkI2SUQ1SUlxaS8yTGlONnN3d1BHR3E4czVZQUM5Y1lqSVFzVjN3SWhGRzhGb0dTNHpOVDhxYTJlSXA2V0ZZeGpyR09lbHJwMVV2MGVZWmFDY0tvMEtBVEJ2eFdhbFJ5cEE1Y2R5eUdUWEJjaGlFbHBFZ1ZuSVVjMFZLUHlyQ3BZK04xcmdkU0Q4RE9NU2l4bHVHMTdRRWxBeGRPRnYvenJIaXNha2oxTHcrQWdSeUVyT29wQzYyNUk2NVRiM0VNOUdOcVNIWHVXcE1tZnpaU29ZZU9yKzVnMjJlZFA1dnZEanVaWWc9PSJdLCJ0eXAiOiJqb3NlIiwiaWF0IjoxNzY0Njg4NjcwfQ.ew0KICAgICJMb1RFIjogew0KICAgICAgICAiTGlzdEFuZFNjaGVtZUluZm9ybWF0aW9uIjogew0KICAgICAgICAgICAgIkxpc3RJc3N1ZURhdGVUaW1lIjogIjIwMjUtMTItMDFUMDg6Mjk6NDFaIiwNCiAgICAgICAgICAgICJMb1RFU2VxdWVuY2VOdW1iZXIiOiAxLA0KICAgICAgICAgICAgIkxvVEVUeXBlIjogImh0dHA6Ly91cmkuZXRzaS5vcmcvMTk2MDIvTG9URVR5cGUvRVVXYWxsZXRQcm92aWRlcnNMaXN0IiwNCiAgICAgICAgICAgICJMb1RFVmVyc2lvbklkZW50aWZpZXIiOiAxLA0KICAgICAgICAgICAgIk5leHRVcGRhdGUiOiAiMjAyNi0wNi0wMVQwODoyOTo0MVoiLA0KICAgICAgICAgICAgIlBvbGljeU9yTGVnYWxOb3RpY2UiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAiTG9URVBvbGljeSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJsYW5nIjogImVuIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ1cmlWYWx1ZSI6ICJodHRwOi8vdHJ1c3QudGVjaC5lYy5ldXJvcGEuZXUvbGlzdHMvZXVkaXcvbGVnYWwtbm90aWNlI0VOIg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICJTY2hlbWVJbmZvcm1hdGlvblVSSSI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogImVuIiwNCiAgICAgICAgICAgICAgICAgICAgInVyaVZhbHVlIjogImh0dHBzOi8vdHJ1c3QudGVjaC5lYy5ldXJvcGEuZXUvbGlzdHMvZXVkaXcvd2FsbGV0LXByb3ZpZGVycy1saXN0LXNjaGVtZS1pbmZvcm1hdGlvbiINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgIlNjaGVtZU5hbWUiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJlbiIsDQogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICJUaGUgcHJlc2VudCBsaXN0IGlzIGEgbGlzdCBvZiBwZXJzb24gaWRlbnRpZmllciBwcm92aWRlcnMgb2YgRVVESSBXYWxsZXQgaXNzdWVkIGluIGFjY29yZGFuY2Ugd2l0aCBDSVIgMjAyNC8yOTgwIg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0sDQogICAgICAgICAgICAiU2NoZW1lT3BlcmF0b3JBZGRyZXNzIjogew0KICAgICAgICAgICAgICAgICJTY2hlbWVPcGVyYXRvckVsZWN0cm9uaWNBZGRyZXNzIjogWw0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJlbiIsDQogICAgICAgICAgICAgICAgICAgICAgICAidXJpVmFsdWUiOiAibWFpbHRvOkRJR0lULUVVLVRSVVNULU5PTi1QUk9EQGVjLmV1cm9wYS5ldSINCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZW4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgInVyaVZhbHVlIjogImh0dHBzOi8vZGlnaXRhbC1zdHJhdGVneS5lYy5ldXJvcGEuZXUvZW4vcG9saWNpZXMvZXUtdHJ1c3RlZC1saXN0cyINCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgIlNjaGVtZU9wZXJhdG9yUG9zdGFsQWRkcmVzcyI6IFsNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgIkNvdW50cnkiOiAiQkUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgIkxvY2FsaXR5IjogIkJydXhlbGxlcyIsDQogICAgICAgICAgICAgICAgICAgICAgICAiUG9zdGFsQ29kZSI6ICIxMDQ5IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJTdHJlZXRBZGRyZXNzIjogIlJ1ZSBkZSBsYSBMb2kgMjAwIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJsYW5nIjogImZyIg0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAiQ291bnRyeSI6ICJCRSIsDQogICAgICAgICAgICAgICAgICAgICAgICAiTG9jYWxpdHkiOiAiQnJ1c3NlbCIsDQogICAgICAgICAgICAgICAgICAgICAgICAiUG9zdGFsQ29kZSI6ICIxMDQ5IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJTdHJlZXRBZGRyZXNzIjogIldldHN0cmFhdCAyMDAiLA0KICAgICAgICAgICAgICAgICAgICAgICAgImxhbmciOiAibmwiDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJDb3VudHJ5IjogIkJFIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJMb2NhbGl0eSI6ICJCcnVzc2VscyIsDQogICAgICAgICAgICAgICAgICAgICAgICAiUG9zdGFsQ29kZSI6ICIxMDQ5IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJTdHJlZXRBZGRyZXNzIjogIlJ1ZSBkZSBsYSBMb2kvV2V0c3RyYWF0IDIwMCIsDQogICAgICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJlbiINCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIF0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiU2NoZW1lT3BlcmF0b3JOYW1lIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZW4iLA0KICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiRXVyb3BlYW4gQ29tbWlzc2lvbiINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiYmciLA0KICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAi0JXQstGA0L7Qv9C10LnRgdC60LAg0LrQvtC80LjRgdC40Y8iDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogImVzIiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIkNvbWlzacOzbiBFdXJvcGVhIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJjcyIsDQogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICJFdnJvcHNrw6Ega29taXNlIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJkYSIsDQogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICJFdXJvcGEtS29tbWlzc2lvbmVuIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJkZSIsDQogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICJFdXJvcMOkaXNjaGUgS29tbWlzc2lvbiINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZXQiLA0KICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiRXVyb29wYSBLb21pc2pvbiINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZWwiLA0KICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAizpXPhc-Bz4nPgM6xz4rOus6uIM6Vz4DOuc-Ez4HOv8-Azq4iDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogImZyIiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIkNvbW1pc3Npb24gZXVyb3DDqWVubmUiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogIml0IiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIkNvbW1pc3Npb25lIGV1cm9wZWEiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogImx2IiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIkVpcm9wYXMgS29taXNpamEiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogImx0IiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIkV1cm9wb3MgS29taXNpamEiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogImh1IiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIkV1csOzcGFpIEJpem90dHPDoWciDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogIm10IiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIklsLUt1bW1pc3Nqb25pIEV3cm9wZWEiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogIm5sIiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIkV1cm9wZXNlIENvbW1pc3NpZSINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImxhbmciOiAicGwiLA0KICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiS29taXNqYSBFdXJvcGVqc2thIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJwdCIsDQogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICJDb21pc3PDo28gRXVyb3BlaWEiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogInJvIiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIkNvbWlzaWEgRXVyb3BlYW7EgyINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImxhbmciOiAic2siLA0KICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiRXVyw7Nwc2thIGtvbWlzaWEiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogInNsIiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIkV2cm9wc2thIGtvbWlzaWphIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJmaSIsDQogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICJFdXJvb3BhbiBrb21pc3NpbyINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImxhbmciOiAic3YiLA0KICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAiRXVyb3BlaXNrYSBrb21taXNzaW9uZW4iDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJsYW5nIjogImhyIiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIkV1cm9wc2thIGtvbWlzaWphIg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF0sDQogICAgICAgICAgICAiU2NoZW1lVGVycml0b3J5IjogIkVVIiwNCiAgICAgICAgICAgICJTY2hlbWVUeXBlQ29tbXVuaXR5UnVsZXMiOiBbDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJlbiIsDQogICAgICAgICAgICAgICAgICAgICJ1cmlWYWx1ZSI6ICJodHRwOi8vdXJpLmV0c2kub3JnLzE5NjAyL1dhbGxldFByb3ZpZGVyc0xpc3Qvc2NoZW1lcnVsZXMvRVUiDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICJTdGF0dXNEZXRlcm1pbmF0aW9uQXBwcm9hY2giOiAiaHR0cDovL3VyaS5ldHNpLm9yZy8xOTYwMi9XYWxsZXRQcm92aWRlcnNMaXN0L1N0YXR1c0RldG4vRVUiDQogICAgICAgIH0sDQogICAgICAgICJUcnVzdGVkRW50aXRpZXNMaXN0IjogWw0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICJUcnVzdGVkRW50aXR5SW5mb3JtYXRpb24iOiB7DQogICAgICAgICAgICAgICAgICAgICJURUFkZHJlc3MiOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAiVEVFbGVjdHJvbmljQWRkcmVzcyI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJsYW5nIjogImVuIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInVyaVZhbHVlIjogIm1haWx0bzp0ZXN0QHRlc3QuaXQiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJsYW5nIjogImVuIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInVyaVZhbHVlIjogInRlbDorMzkxMjM0NTY3ODkiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJURVBvc3RhbEFkZHJlc3MiOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQ291bnRyeSI6ICJJVCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJMb2NhbGl0eSI6ICJUZXN0IGxvY2FsaXR5IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlBvc3RhbENvZGUiOiAiMTIzNDUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU3RhdGVPclByb3ZpbmNlIjogIlRlc3QgcHJvdmluY2UiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU3RyZWV0QWRkcmVzcyI6ICJUZXN0IHN0cmVldCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJsYW5nIjogImVuIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIF0NCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgIlRFSW5mb3JtYXRpb25VUkkiOiBbDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZW4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1cmlWYWx1ZSI6ICJodHRwczovL3Rlc3QuaXQiDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJsYW5nIjogImVuIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXJpVmFsdWUiOiAiaHR0cDovL3VyaS5ldHNpLm9yZy8xOTYwMi9MaXN0T2ZUcnVzdGVkRW50aXRpZXMvV2FsbGV0UHJvdmlkZXIvSVQiDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgICAgICJURU5hbWUiOiBbDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZW4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICJQYWdvUEEgV2FsbGV0IFByb3ZpZGVyIFJvb3QgQ0EiDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgICAgICJURVRyYWRlTmFtZSI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJlbiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogIlZBVElULTEyMzQ1Njc4OSINCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIlRydXN0ZWRFbnRpdHlTZXJ2aWNlcyI6IFsNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgIlNlcnZpY2VJbmZvcm1hdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2VydmljZURpZ2l0YWxJZGVudGl0eSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlg1MDlDZXJ0aWZpY2F0ZXMiOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbCI6ICJNSUlDVURDQ0FmV2dBd0lCQWdJVU9ObElQU3F5RlFWalQ2K3l5MXpBRkxTK2ZPVXdDZ1lJS29aSXpqMEVBd0l3ZlRFTE1Ba0dBMVVFQmhNQ1NWUXhDekFKQmdOVkJBZ01BbEpOTVEwd0N3WURWUVFIREFSU2IyMWxNUll3RkFZRFZRUUtEQTFRWVdkdlVFRWdVeTV3TGtFdU1SRXdEd1lEVlFRTERBaFRaV04xY21sMGVURW5NQ1VHQTFVRUF3d2VVR0ZuYjFCQklGZGhiR3hsZENCUWNtOTJhV1JsY2lCU2IyOTBJRU5CTUI0WERUSTFNVEV5TVRFMk1EY3hPRm9YRFRNMU1URXhPVEUyTURjeE9Gb3dmVEVMTUFrR0ExVUVCaE1DU1ZReEN6QUpCZ05WQkFnTUFsSk5NUTB3Q3dZRFZRUUhEQVJTYjIxbE1SWXdGQVlEVlFRS0RBMVFZV2R2VUVFZ1V5NXdMa0V1TVJFd0R3WURWUVFMREFoVFpXTjFjbWwwZVRFbk1DVUdBMVVFQXd3ZVVHRm5iMUJCSUZkaGJHeGxkQ0JRY205MmFXUmxjaUJTYjI5MElFTkJNRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFnQUVzT0NLRFBNcnFHM0RLTEhBRXFrdXRCS0NCSGxTbXV5ZVFHa0xMOTVFVzRvQXpxVmQrMWFWUGZYR05LU0U2ZGdHYjJ3YnJjcU56L3dMeW9UZEJoM3BrYU5UTUZFd0hRWURWUjBPQkJZRUZGZHpmZWFxYi9FVEM1WW9CNE9kNWg0alZEN1ZNQjhHQTFVZEl3UVlNQmFBRkZkemZlYXFiL0VUQzVZb0I0T2Q1aDRqVkQ3Vk1BOEdBMVVkRXdFQi93UUZNQU1CQWY4d0NnWUlLb1pJemowRUF3SURTUUF3UmdJaEFQOExoT09FQjhIUE54MHNvYklCUWdTM0VqMXJ0elhjeDRoZ2dBZnlGRlRKQWlFQW1KTUpBMXRnQi9rbDJnbUg1VEtIMlI0UWFXZUhtZ0FaU0ZRY2RaN3lFRk09Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2VydmljZUluZm9ybWF0aW9uRXh0ZW5zaW9ucyI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlNlcnZpY2VVbmlxdWVJZGVudGlmaWVyIjogIm9qZXU6ZXVkaXc6cmVmX2V1ZGl3X3NvbHV0aW9uX2l0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2VydmljZU5hbWUiOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJsYW5nIjogImVuIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICJuYW1lX2V1ZGl3X3NvbHV0aW9uX2l0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2VydmljZVR5cGVJZGVudGlmaWVyIjogImh0dHA6Ly91cmkuZXRzaS5vcmcvMTk2MDIvU3ZjVHlwZS9XYWxsZXRTb2x1dGlvbi9Jc3N1YW5jZSINCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIF0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICx7DQogICAgICAgICAgICAgICAgIlRydXN0ZWRFbnRpdHlJbmZvcm1hdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAgICAgIlRFQWRkcmVzcyI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJURUVsZWN0cm9uaWNBZGRyZXNzIjogWw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZW4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXJpVmFsdWUiOiAibWFpbHRvOnRlc3RAdGVzdC5odSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZW4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXJpVmFsdWUiOiAidGVsOiszNjEyMzQ1NiINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgIlRFUG9zdGFsQWRkcmVzcyI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJDb3VudHJ5IjogIkhVIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkxvY2FsaXR5IjogIlRlc3QgbG9jYWxpdHkiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUG9zdGFsQ29kZSI6ICIxMjM0NTYiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU3RhdGVPclByb3ZpbmNlIjogIlRlc3QgcHJvdmluY2UiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU3RyZWV0QWRkcmVzcyI6ICJUZXN0IHN0cmVldCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJsYW5nIjogImVuIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIF0NCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgIlRFSW5mb3JtYXRpb25VUkkiOiBbDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZW4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1cmlWYWx1ZSI6ICJodHRwczovL3Rlc3QuaHUiDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJsYW5nIjogImVuIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidXJpVmFsdWUiOiAiaHR0cDovL3VyaS5ldHNpLm9yZy8xOTYwMi9MaXN0T2ZUcnVzdGVkRW50aXRpZXMvV2FsbGV0UHJvdmlkZXIvSFUiDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgICAgICJURU5hbWUiOiBbDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZW4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICJNaWNyb3NlYyBMdGQuIg0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgICAgICAgICAiVEVUcmFkZU5hbWUiOiBbDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImxhbmciOiAiZW4iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6ICJWQVRIVS0yMzU4NDQ5NyINCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIlRydXN0ZWRFbnRpdHlTZXJ2aWNlcyI6IFsNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgIlNlcnZpY2VJbmZvcm1hdGlvbiI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2VydmljZURpZ2l0YWxJZGVudGl0eSI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlg1MDlDZXJ0aWZpY2F0ZXMiOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbCI6ICJNSUlEUXpDQ0F1aWdBd0lCQWdJTUJjS01KWGd5MjI3MldIUUtNQW9HQ0NxR1NNNDlCQU1DTUhZeEN6QUpCZ05WQkFZVEFraFZNUkV3RHdZRFZRUUhEQWhDZFdSaGNHVnpkREVXTUJRR0ExVUVDZ3dOVFdsamNtOXpaV01nVEhSa0xqRVhNQlVHQTFVRVlRd09Wa0ZVU0ZVdE1qTTFPRFEwT1RjeEl6QWhCZ05WQkFNTUdsUmxjM1FnWlMxVGVtbG5ibThnVW05dmRDQkRRU0F5TURFM01CNFhEVEUzTURreU1qSXdNREF3TUZvWERUUXlNRGt5TWpBMk1EQXdNRm93Y1RFTE1Ba0dBMVVFQmhNQ1NGVXhFVEFQQmdOVkJBY01DRUoxWkdGd1pYTjBNUll3RkFZRFZRUUtEQTFOYVdOeWIzTmxZeUJNZEdRdU1SY3dGUVlEVlFSaERBNVdRVlJJVlMweU16VTRORFE1TnpFZU1Cd0dBMVVFQXd3VlZHVnpkQ0JsTFZONmFXZHVieUJEUVNBeU1ERTNNRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFnQUVsS1l6T1B0QWRkMm9oU2Z3RWdYMkErWnIyalhXckVxQXdKWVJzOWFCanhUNjdWd3VEMTBSK1RFWTBhUnd6YnJBQVBmUjJoc09yOURjdlpsaDRBWFJyYU9DQVY4d2dnRmJNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdEZ1lEVlIwUEFRSC9CQVFEQWdFR01ENEdBMVVkSUFRM01EVXdNd1lFVlIwZ0FEQXJNQ2tHQ0NzR0FRVUZCd0lCRmgxb2RIUndPaTh2ZEdWemVuUXVaUzF6ZW1sbmJtOHVhSFV2Y1dOd2N6QWRCZ05WSFE0RUZnUVVlcHRvaDQ1NGhoYnp0L2sySHZnYW1MTmtISWt3SHdZRFZSMGpCQmd3Rm9BVWtsRFpCUEhrejdKU0h5UUtnWVRpT08yZE80NHdPUVlEVlIwZkJESXdNREF1b0N5Z0tvWW9hSFIwY0RvdkwzUmxjM3AwTG1VdGMzcHBaMjV2TG1oMUwzUnliMjkwWTJFeU1ERTNMbU55YkRCOUJnZ3JCZ0VGQlFjQkFRUnhNRzh3TndZSUt3WUJCUVVITUFHR0syaDBkSEE2THk5MFpYTjZkQzVsTFhONmFXZHVieTVvZFM5MFpYTjBjbTl2ZEdOaE1qQXhOMjlqYzNBd05BWUlLd1lCQlFVSE1BS0dLR2gwZEhBNkx5OTBaWE42ZEM1bExYTjZhV2R1Ynk1b2RTOTBjbTl2ZEdOaE1qQXhOeTVqY25Rd0NnWUlLb1pJemowRUF3SURTUUF3UmdJaEFMK0Y3QkhFRFV2Vi93ZVRuZjRUd3p3RElzc2wwaE1GLzBvS28wYzlDYVhYQWlFQXZOcGZTQUpqbFU5a0Nxc1JWVVlWUXFWZmZKQ3VCUElLZEZ2ZmNlandmYlk9Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU2VydmljZUluZm9ybWF0aW9uRXh0ZW5zaW9ucyI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlNlcnZpY2VVbmlxdWVJZGVudGlmaWVyIjogIm9qZXU6ZXVkaXc6cmVmX3dhbGxldF9zb2x1dGlvbl9odSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlNlcnZpY2VOYW1lIjogWw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibGFuZyI6ICJlbiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiAibmFtZV93YWxsZXRfc29sdXRpb25fb2pldV9odSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlNlcnZpY2VUeXBlSWRlbnRpZmllciI6ICJodHRwOi8vdXJpLmV0c2kub3JnLzE5NjAyL1N2Y1R5cGUvV2FsbGV0U29sdXRpb24vSXNzdWFuY2UiDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICB9DQogICAgICAgIF0NCiAgICB9DQp9.Qi1t9UvAdRj6WfJo1zbUrJNDclMG5cmedSo34HiM_ksYmo-ZeS9tdNri6UV3K02oVTWysKcojOBTEenxq4NNhTlgZO0JG1L5U0lgqEX9cvp1irKrAYKbOW5aHOyEM8XO1qgGFxdf2St6XY4mvojFlNg7arMfdBi7g1MVsgtY5ejhtYdD9P2LRWQa6yX7z9iN8j2T8hyA05Eh-1o8WPiLspvdTDXjKJdSv9d0hHRwKTMV2_ksFt2wg0Ssdn5HUK_9NccOCvDurYa4a-QDh5yoMBeZuUifM07ZOYzzukqUp5QAdSjIOnRWCHv7NobxskcJgto7yWY39b2UPz85lg2T7ryab4AkSBRRAIY6BUHQWC8w9uwhMuTUfhErgkRyGuR4RVhGT4PgVhXYP2RF1rsCSabmDbG7B2ZU8hFe0_Ape0fX5maOR3LqHV7ZfssmGBUbUhhfTze8mPbLq1soWE4cwOyGWm2bDJ79PJwhjqPxnCViAo4VG6dMckNt4RJ0M3q0xdTKEvxPTFoQRf8lbAtqjSkBXKRky9R5PxNMfNEAGvEU9RKyuvT-pYZ_fi5w1UKwfyVYgnjNxMo_FCBeP2W3-eTVKmQXbjmBFZSNEQU-Uim13T4SClF4DWw0e5iA6WuIIoXt56XsxoT6niGLlEacra-v0K8xzL8QM1oP2ll5n6c"
}
